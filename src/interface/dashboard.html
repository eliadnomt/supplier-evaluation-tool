<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Supplier Scorecard Tool</title>
  <link rel="stylesheet" href="/static/css/dashboard.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
  <div class="container">
    <header>
      <h1>SUPPLIER SCORECARD TOOL</h1>
      <p class="subtitle">Making responsible sourcing simpler</p>
    </header>

    <div class="charts-section">
      <div class="chart-container">
        <div class="chart-title">COTTON</div>
        <canvas id="cottonChart"></canvas>
        <div class="chart-legend"></div>
      </div>

      <div class="chart-container">
        <div class="chart-title">WOOL</div>
        <canvas id="woolChart"></canvas>
        <div class="chart-legend"></div>
      </div>

      <div class="chart-container">
        <div class="chart-title">COMPOSITE</div>
        <canvas id="compositeChart"></canvas>
        <div class="chart-legend"></div>
      </div>
    </div>

    <div class="chart-reading-section" id="chartReadingSection" style="display: none;">
      <h3>HOW TO READ THESE CHARTS</h3>
      <p>All axes are scored on a 0 to 10 scale, where scores are relative to the suppliers currently being compared, not fixed benchmarks.</p>
      <p><strong>For Ecobalyse, Price, Lead Time, and MOQ:</strong> Lower values are better. Suppliers with the lowest values receive higher scores (closer to 10), while suppliers with the highest values receive lower scores (closer to 0). When new suppliers are added, scores automatically rescale to reflect the new range.</p>
      <p><strong>For Transparency:</strong> This score is based on how many production steps are traceable (fibre, spinning, weaving/knitting, dyeing/finishing, making). The score is calculated independently as a completeness measure (known steps / 5 total steps × 10), not compared relative to other suppliers.</p>
      <p>If only one supplier is present, all axes score 5 to avoid showing a misleading "ideal" shape.</p>
    </div>

    <div class="buttons-section">
      <button class="btn" id="addSupplierBtn">ADD SUPPLIER</button>
      <button class="btn" id="viewSuppliersBtn">VIEW SUPPLIERS</button>
      <button class="btn" id="ecobalyseBtn">ECOBALYSE</button>
      <button class="btn" id="howToReadBtn">CHART EXPLAINER</button>
    </div>

    <div class="suppliers-section" id="suppliersSection">
      <h3>Suppliers</h3>
      <div class="suppliers-list" id="suppliersList">
        <div class="suppliers-loading">Loading suppliers...</div>
      </div>
    </div>

    <div class="description">
      <p>This tool helps you compare material suppliers at a glance. Each radar chart shows how suppliers perform across five key factors: price, minimum order quantity, lead time, transparency and the Ecobalyse environmental score.</p>
      <p>The goal is not to find a single "perfect" supplier, but to make the trade-offs visible and easier to discuss.</p>
      <p>You can add suppliers, adjust assumptions and view them side by side to support responsible sourcing decisions.</p>
    </div>

    <div class="powered-by">
      <div class="powered-by-text">Powered with</div>
      <img src="/static/ecobalyse-logo.png" alt="Ecobalyse" class="logo-img" />
    </div>

    <footer>
      <p>© 2025 – Site by Delia Montgomery for ENAMOMA Bourrienne case study<br>Group: Juana Villate-Ricardo, Thayna Tavares, Delia Montgomery, Laura Lemos, Dorka Petrov</p>
    </footer>
  </div>

  <!-- Modal for Add Supplier -->
  <div class="modal-overlay" id="addSupplierModal">
    <div class="modal-content">
      <button class="modal-close" id="closeModal">&times;</button>
      <h2>Enter Supplier Information</h2>
      <form id="supplierForm">
        <label>Supplier Name: <input name="supplier" required></label>
        <label>Business Size: <select name="businessSize" id="businessSizeSelect"></select></label>
        <label>Garment type: <select name="product" id="productSelect"></select></label>

        <label id="mat-origin-label">Material origin:</label>
        <div id="materialsSection"></div>
        <button type="button" class="add-btn" id="addMaterialBtn">Add Material</button>
        <div id="matOriginWarn" class="warn" style="display:none"></div>

        <h3>Country of origin</h3>
        <label>Spinning: <select name="countrySpinning" id="spinningCountrySelect"></select></label>
        <label>Fabric: <select name="countryFabric" id="fabricCountrySelect"></select></label>
        <label>Dyeing: <select name="countryDyeing" id="dyeingCountrySelect"></select></label>
        <label>Making: <select name="countryMaking" id="makingCountrySelect"></select></label>

        <h3>Fabric production specifications</h3>
        <label>Fabric Process: <select name="fabricProcess" id="fabricProcessSelect"></select></label>
        <label>Dyeing Process: <select name="dyeingProcess" id="dyeingProcessSelect"></select></label>
        <label>Making Complexity: <select name="makingComplexity" id="makingComplexitySelect"></select></label>
        <label>Gross fabric width (cm): <input name="gross_width" type="number" step="0.01" required></label>
        <label>Weight (g/m²): <input name="weight_gm2" type="number" step="0.1" required></label>
        <label>Price €/m: <input name="price_eur_per_m" type="number" step="0.01" required></label>
        <label>MOQ (m): <input name="moq_m" type="number" step="0.01" required></label>

        <h3>Production run specifications</h3>
        <label>Number of articles: <input name="numberOfReferences" type="number" required></label>
        <label>Price per article (€): <input name="price" type="number" step="0.01" required></label>
        <label>Lead Time (weeks): <input name="lead_time_weeks" type="number" step="1" required></label>
        
        <button type="submit" class="btn" style="margin-top: 20px;">Save Supplier</button>
        <div id="status"></div>
      </form>
    </div>
  </div>

  <!-- Modal for Ecobalyse Information -->
  <div class="modal-overlay" id="ecobalyseModal">
    <div class="info-modal-content">
      <button class="modal-close" id="closeEcobalyseModal">&times;</button>
      <h2>How This Tool Uses Ecobalyse</h2>
      
      <div class="info-section">
        <p>This tool integrates with the Ecobalyse API to calculate environmental impact scores for textile suppliers. The Ecobalyse score provides a comprehensive environmental assessment based on multiple factors including material composition, production processes, and geographic locations.</p>
      </div>

      <div class="info-section">
        <h3>Assumed Constant Fields</h3>
        <p>The following fields are set to default values based on the example product and remain constant across all supplier evaluations:</p>
        
        <div class="constant-fields">
          <h4>For Shirts</h4>
          <ul>
            <li><strong>Product type:</strong> 'chemise'</li>
            <li><strong>Final product weight:</strong> 0.1 kg</li>
            <li><strong>Upcycled:</strong> No</li>
            <li><strong>Buttons (trims):</strong> 10 plastic buttons</li>
            <li><strong>Garment distribution:</strong> France</li>
            <li><strong>Garment use:</strong> France</li>
            <li><strong>End of life:</strong> France</li>
          </ul>
        </div>

        <div class="constant-fields">
          <h4>For Sweaters</h4>
          <ul>
            <li><strong>Product type:</strong> 'pull'</li>
            <li><strong>Final product weight:</strong> 0.2 kg</li>
            <li><strong>Upcycled:</strong> No</li>
            <li><strong>Buttons (trims):</strong> None</li>
            <li><strong>Garment distribution:</strong> France</li>
            <li><strong>Garment use:</strong> France</li>
            <li><strong>End of life:</strong> France</li>
          </ul>
        </div>
      </div>

      <div class="info-section">
        <h3>Variable Fields Based on Supplier Information</h3>
        <p>The following fields are dynamically adjusted based on the supplier data you provide:</p>
        <div class="adjustable-fields">
          <h4>Supplier-Specific Parameters</h4>
          <div class="field-list">
            <div class="field-item">Supplier business size</div>
            <div class="field-item">Price (€ per m)</div>
            <div class="field-item">MOQ (m)</div>
            <div class="field-item">Material origin (type, percentage of composition, spinning type)</div>
            <div class="field-item">Spinning origin</div>
            <div class="field-item">Fabric production origin</div>
            <div class="field-item">Fabric processing type</div>
            <div class="field-item">Dyeing origin</div>
            <div class="field-item">Dyeing processing type</div>
            <div class="field-item">Gross fabric width (cm)</div>
            <div class="field-item">Weight (g/m²)</div>
            <div class="field-item">Garment type</div>
            <div class="field-item">Garment production origin</div>
            <div class="field-item">Garment production complexity</div>
            <div class="field-item">Number of garments</div>
            <div class="field-item">Price per garment</div>
          </div>
        </div>
      </div>

      <div class="info-section">
        <h3>How Scores Are Calculated</h3>
        <p>The Ecobalyse API returns an environmental impact score (ECS). This score is normalized on a scale from 0-10 to be displayed as an independent variable the radar charts, allowing for direct comparison across suppliers.</p>
        <p>For more detailed information about Ecobalyse methodology, please visit the <a href="https://fabrique-numerique.gitbook.io/ecobalyse" target="_blank">official Ecobalyse documentation</a>.</p>
      </div>
    </div>
  </div>

  <script src="/static/js/form-utils.js"></script>
  <script src="/static/js/radar-scoring.js"></script>
  <script src="/static/js/radar-charts.js"></script>
  <script src="/static/js/dashboard.js"></script>
  <script>
    // Load radar charts on page load
    window.addEventListener('DOMContentLoaded', () => {
      loadAndRenderRadarCharts();
    });
  </script>
</body>
</html>
